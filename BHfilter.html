<!DOCTYPE html>
<html>
    
    <center><img id="html5" src="testing_distortion_truecolor.png" width="400"/ align="middle"></center>
    <div class ="blurb">
      <p> <font size = "20">
	Want to see what your face would look like if we put a black hole in front of it like in the image above?  Choose a file and then hit the "Render Image" button!</font>
      </p>
    </div>




<!--<label>Image File:</label><br/>-->

<input type="file" id="imageLoader" name="imageLoader"/>
<canvas id="imageCanvas"></canvas>
<canvas id="transformedCanvas"></canvas>
<p>Choose a file and then click render image </p>

    
<button type="button" id="myBtn">Render Image</button>
<p id="demo"></p>
<script>

var imageLoader = document.getElementById('imageLoader');
    imageLoader.addEventListener('change', handleImage, false);

var imageRender = document.getElementById('myBtn');
    imageRender.addEventListener("click",renderFunc);

function clickFunc(){
    document.getElementById("demo").innerHTML = "Button working!";

}


var canvas = document.getElementById('imageCanvas');
var ctx = canvas.getContext('2d');

var canvas2 = document.getElementById('transformedCanvas');
var ctx2 = canvas2.getContext('2d');


var impactlist = [0.8660,0.8758,0.8856,0.8953,0.9051,0.9148,0.9245,0.9341,0.9438,0.9534,0.9630,0.9725,0.9821,0.9916,1.0012,1.0107,1.0201,1.0296,1.0391,1.0485,1.0579,1.0673,1.0767,1.0861,1.0954,1.1048,1.1141,1.1234,1.1327,1.1420,1.1513,1.1606,1.1699,1.1791,1.1883,1.1976,1.2068,1.2160,1.2252,1.2344,1.2435,1.2527,1.2619,1.2710,1.2801,1.2893,1.2984,1.3075,1.3166,1.3257,1.3348,1.3439,1.3530,1.3620,1.3711,1.3801,1.3892,1.3982,1.4073,1.4163,1.4253,1.4343,1.4433,1.4523,1.4613,1.4703,1.4793,1.4883,1.4973,1.5062,1.5152,1.5241,1.5331,1.5420,1.5510,1.5599,1.5688,1.5778,1.5867,1.5956,1.6045,1.6134,1.6223,1.6312,1.6401,1.6490,1.6579,1.6668,1.6757,1.6846,1.6934,1.7023,1.7112,1.7200,1.7289,1.7378,1.7466,1.7555,1.7643,1.7731,1.7820,1.7908,1.7997,1.8085,1.8173,1.8261,1.8350,1.8438,1.8526,1.8614,1.8702,1.8790,1.8878,1.8966,1.9054,1.9142,1.9230,1.9318,1.9406,1.9494,1.9581,1.9669,1.9757,1.9845,1.9933,2.0020,2.0108,2.0196,2.0283,2.0371,2.0458,2.0546,2.0634,2.0721,2.0809,2.0896,2.0984,2.1071,2.1159,2.1246,2.1333,2.1421,2.1508,2.1595,2.1683,2.1770,2.1857,2.1945,2.2032,2.2119,2.2206,2.2294,2.2381,2.2468,2.2555,2.2642,2.2729,2.2816,2.2904,2.2991,2.3078,2.3165,2.3252,2.3339,2.3426,2.3513,2.3600,2.3687,2.3774,2.3861,2.3948,2.4034,2.4121,2.4208,2.4295,2.4382,2.4469,2.4556,2.4643,2.4729,2.4816,2.4903,2.4990,2.5076,2.5163,2.5250,2.5337,2.5423,2.5510,2.5597,2.5684,2.5770,2.5857,2.5944,2.6030,2.6117,2.6203,2.6290,2.6377,2.6463,2.6550,2.6636,2.6723,2.6810,2.6896,2.6983,2.7069,2.7156,2.7242,2.7329,2.7415,2.7502,2.7588,2.7675,2.7761,2.7847,2.7934,2.8020,2.8107,2.8193,2.8280,2.8366,2.8452,2.8539,2.8625,2.8712,2.8798,2.8884,2.8971,2.9057,2.9143,2.9230,2.9316,2.9402,2.9489,2.9575,2.9661,2.9747,2.9834,2.9920,3.0006,3.0092,3.0179,3.0265,3.0351,3.0437,3.0524,3.0610,3.0696,3.0782,3.0868,3.0955,3.1041,3.1127,3.1213,3.1299,3.1386,3.1472,3.1558,3.1644,3.1730,3.1816,3.1902,3.1988,3.2075,3.2161,3.2247,3.2333,3.2419,3.2505,3.2591,3.2677,3.2763,3.2849,3.2935,3.3022,3.3108,3.3194,3.3280,3.3366,3.3452,3.3538,3.3624,3.3710,3.3796,3.3882,3.3968,3.4054,3.4140,3.4226,3.4312,3.4398,3.4484,3.4570,3.4656,3.4742,3.4828,3.4914,3.5000,3.5085,3.5171,3.5257,3.5343,3.5429,3.5515,3.5601,3.5687,3.5773,3.5859,3.5945,3.6031,3.6117,3.6202,3.6288,3.6374,3.6460,3.6546,3.6632,3.6718,3.6804,3.6889,3.6975,3.7061,3.7147,3.7233,3.7319,3.7405,3.7490,3.7576,3.7662,3.7748,3.7834,3.7920,3.8005,3.8091,3.8177,3.8263,3.8349,3.8434,3.8520,3.8606,3.8692,3.8778,3.8863,3.8949,3.9035,3.9121,3.9206,3.9292,3.9378,3.9464,3.9550,3.9635,3.9721,3.9807,3.9893,3.9978,4.0064,4.0150,4.0236,4.0321,4.0407,4.0493,4.0579,4.0664,4.0750,4.0836,4.0921,4.1007,4.1093,4.1179,4.1264,4.1350,4.1436,4.1521,4.1607,4.1693,4.1778,4.1864,4.1950,4.2036,4.2121,4.2207,4.2293,4.2378,4.2464,4.2550,4.2635,4.2721,4.2807,4.2892,4.2978,4.3064,4.3149,4.3235,4.3321,4.3406,4.3492,4.3577,4.3663,4.3749,4.3834,4.3920,4.4006,4.4091,4.4177,4.4263,4.4348,4.4434,4.4519,4.4605,4.4691,4.4776,4.4862,4.4947,4.5033,4.5119,4.5204,4.5290,4.5376,4.5461,4.5547,4.5632,4.5718,4.5803,4.5889,4.5975,4.6060,4.6146,4.6231,4.6317,4.6403,4.6488,4.6574,4.6659,4.6745,4.6830,4.6916,4.7002,4.7087,4.7173,4.7258,4.7344,4.7429,4.7515,4.7600,4.7686,4.7772,4.7857,4.7943,4.8028,4.8114,4.8199,4.8285,4.8370,4.8456,4.8541,4.8627,4.8713,4.8798,4.8884,4.8969,4.9055,4.9140,4.9226,4.9311,4.9397,4.9482,4.9568,4.9653,4.9739,4.9824,4.9910,4.9995,5.0081,5.0166,5.0252,5.0337,5.0423,5.0508,5.0594,5.0679,5.0765,5.0850,5.0936,5.1021,5.1107,5.1192,5.1278,5.1363,5.1449,5.1534,5.1620,5.1705,5.1791,5.1876,5.1962,5.2047,5.2133,5.2218,5.2304,5.2389,5.2475,5.2560,5.2645,5.2731,5.2816,5.2902,5.2987,5.3073,5.3158,5.3244,5.3329,5.3415,5.3500,5.3586,5.3671,5.3756,5.3842,5.3927,5.4013,5.4098,5.4184,5.4269,5.4355,5.4440,5.4525,5.4611,5.4696,5.4782,5.4867,5.4953,5.5038,5.5124,5.5209,5.5294,5.5380,5.5465,5.5551,5.5636,5.5722,5.5807,5.5892,5.5978,5.6063,5.6149,5.6234,5.6320,5.6405,5.6490,5.6576,5.6661,5.6747,5.6832,5.6917,5.7003,5.7088,5.7174,5.7259,5.7344,5.7430,5.7515,5.7601,5.7686,5.7772,5.7857,5.7942,5.8028,5.8113,5.8199,5.8284,5.8369,5.8455,5.8540,5.8626,5.8711,5.8796,5.8882,5.8967,5.9052,5.9138,5.9223,5.9309,5.9394,5.9479,5.9565,5.9650,5.9736,5.9821,5.9906,5.9992,6.0077,6.0162,6.0248,6.0333,6.0419,6.0504,6.0589,6.0675,6.0760,6.0845,6.0931,6.1016,6.1102,6.1187,6.1272,6.1358,6.1443,6.1528,6.1614,6.1699,6.1785,6.1870,6.1955,6.2041,6.2126,6.2211,6.2297,6.2382,6.2467,6.2553,6.2638,6.2723,6.2809,6.2894,6.2980,6.3065,6.3150,6.3236,6.3321,6.3406,6.3492,6.3577,6.3662,6.3748,6.3833,6.3918,6.4004,6.4089,6.4174,6.4260,6.4345,6.4430,6.4516,6.4601,6.4686,6.4772,6.4857,6.4942,6.5028,6.5113,6.5198,6.5284,6.5369,6.5454,6.5540,6.5625,6.5710,6.5796,6.5881,6.5966,6.6052,6.6137,6.6222,6.6308,6.6393,6.6478,6.6564,6.6649,6.6734,6.6820,6.6905,6.6990,6.7076,6.7161,6.7246,6.7332,6.7417,6.7502,6.7588,6.7673,6.7758,6.7844,6.7929,6.8014,6.8099,6.8185,6.8270,6.8355,6.8441,6.8526,6.8611,6.8697,6.8782,6.8867,6.8953,6.9038,6.9123,6.9209,6.9294,6.9379,6.9464,6.9550,6.9635,6.9720,6.9806,6.9891,6.9976,7.0062,7.0147,7.0232,7.0317,7.0403,7.0488,7.0573,7.0659,7.0744,7.0829,7.0915,7.1000,7.1085,7.1170,7.1256,7.1341,7.1426,7.1512,7.1597,7.1682,7.1767,7.1853,7.1938,7.2023,7.2109,7.2194,7.2279,7.2365,7.2450,7.2535,7.2620,7.2706,7.2791,7.2876,7.2962,7.3047,7.3132,7.3217,7.3303,7.3388,7.3473,7.3558,7.3644,7.3729,7.3814,7.3900,7.3985,7.4070,7.4155,7.4241,7.4326,7.4411,7.4497,7.4582,7.4667,7.4752,7.4838,7.4923,7.5008,7.5093,7.5179,7.5264,7.5349,7.5435,7.5520,7.5605,7.5690,7.5776,7.5861,7.5946,7.6031,7.6117,7.6202,7.6287,7.6373,7.6458,7.6543,7.6628,7.6714,7.6799,7.6884,7.6969,7.7055,7.7140,7.7225,7.7310,7.7396,7.7481,7.7566,7.7652,7.7737,7.7822,7.7907,7.7993,7.8078,7.8163,7.8248,7.8334,7.8419,7.8504,7.8589,7.8675,7.8760,7.8845,7.8930,7.9016,7.9101,7.9186,7.9271,7.9357,7.9442,7.9527,7.9612,7.9698,7.9783,7.9868,7.9953,8.0039,8.0124,8.0209,8.0294,8.0380,8.0465,8.0550,8.0635,8.0721,8.0806,8.0891,8.0976,8.1062,8.1147,8.1232,8.1317,8.1403,8.1488,8.1573,8.1658,8.1744,8.1829,8.1914,8.1999,8.2085,8.2170,8.2255,8.2340,8.2426,8.2511,8.2596,8.2681,8.2767,8.2852,8.2937,8.3022,8.3107,8.3193,8.3278,8.3363,8.3448,8.3534,8.3619,8.3704,8.3789,8.3875,8.3960,8.4045,8.4130,8.4216,8.4301,8.4386,8.4471,8.4557,8.4642,8.4727,8.4812,8.4897,8.4983,8.5068,8.5153,8.5238,8.5324,8.5409,8.5494,8.5579,8.5665,8.5750,8.5835,8.5920,8.6005,8.6091,8.6176,8.6261,8.6346,8.6432,8.6517,8.6602,8.6687,8.6772,8.6858,8.6943,8.7028,8.7113,8.7199,8.7284,8.7369,8.7454,8.7540,8.7625,8.7710,8.7795,8.7880,8.7966,8.8051,8.8136,8.8221,8.8307,8.8392,8.8477,8.8562,8.8647,8.8733,8.8818,8.8903,8.8988,8.9073,8.9159,8.9244,8.9329,8.9414,8.9500,8.9585,8.9670,8.9755,8.9840,8.9926,9.0011,9.0096,9.0181,9.0267,9.0352,9.0437,9.0522,9.0607,9.0693,9.0778,9.0863,9.0948,9.1033,9.1119,9.1204,9.1289,9.1374,9.1460,9.1545,9.1630,9.1715,9.1800,9.1886,9.1971,9.2056,9.2141,9.2226,9.2312,9.2397,9.2482,9.2567,9.2652,9.2738,9.2823,9.2908,9.2993,9.3079,9.3164,9.3249,9.3334,9.3419,9.3505,9.3590,9.3675,9.3760,9.3845,9.3931,9.4016,9.4101,9.4186,9.4271,9.4357,9.4442,9.4527,9.4612,9.4697,9.4783,9.4868];
var deflist = [11.013,8.5970,7.4967,6.7943,6.2820,5.8808,5.5522,5.2747,5.0351,4.8248,4.6376,4.4694,4.3167,4.1772,4.0490,3.9304,3.8203,3.7176,3.6214,3.5312,3.4461,3.3658,3.2898,3.2178,3.1492,3.0840,3.0217,2.9623,2.9054,2.8508,2.7986,2.7483,2.7001,2.6536,2.6088,2.5656,2.5239,2.4837,2.4448,2.4071,2.3707,2.3353,2.3011,2.2679,2.2356,2.2043,2.1739,2.1443,2.1155,2.0875,2.0603,2.0337,2.0078,1.9826,1.9580,1.9340,1.9105,1.8877,1.8653,1.8435,1.8221,1.8013,1.7809,1.7609,1.7414,1.7222,1.7035,1.6852,1.6672,1.6496,1.6324,1.6155,1.5989,1.5826,1.5666,1.5510,1.5356,1.5205,1.5057,1.4912,1.4769,1.4629,1.4491,1.4355,1.4222,1.4091,1.3962,1.3836,1.3711,1.3589,1.3468,1.3350,1.3233,1.3118,1.3005,1.2893,1.2784,1.2676,1.2569,1.2465,1.2361,1.2260,1.2159,1.2060,1.1963,1.1867,1.1772,1.1679,1.1587,1.1496,1.1407,1.1318,1.1231,1.1145,1.1060,1.0976,1.0894,1.0812,1.0732,1.0652,1.0574,1.0496,1.0419,1.0344,1.0269,1.0195,1.0123,1.0051,0.9979,0.9909,0.9840,0.9771,0.9703,0.9636,0.9570,0.9504,0.9440,0.9376,0.9312,0.9250,0.9188,0.9127,0.9066,0.9006,0.8947,0.8888,0.8831,0.8773,0.8716,0.8660,0.8605,0.8550,0.8495,0.8442,0.8388,0.8335,0.8283,0.8232,0.8180,0.8130,0.8080,0.8030,0.7981,0.7932,0.7884,0.7836,0.7789,0.7742,0.7696,0.7650,0.7604,0.7559,0.7514,0.7470,0.7426,0.7383,0.7340,0.7297,0.7255,0.7213,0.7172,0.7130,0.7090,0.7049,0.7009,0.6969,0.6930,0.6891,0.6852,0.6814,0.6776,0.6738,0.6701,0.6664,0.6627,0.6591,0.6554,0.6519,0.6483,0.6448,0.6413,0.6378,0.6344,0.6310,0.6276,0.6242,0.6209,0.6176,0.6143,0.6111,0.6078,0.6046,0.6015,0.5983,0.5952,0.5921,0.5890,0.5859,0.5829,0.5799,0.5769,0.5740,0.5710,0.5681,0.5652,0.5623,0.5595,0.5566,0.5538,0.5510,0.5482,0.5455,0.5428,0.5400,0.5373,0.5347,0.5320,0.5294,0.5268,0.5242,0.5216,0.5190,0.5165,0.5139,0.5114,0.5089,0.5065,0.5040,0.5015,0.4991,0.4967,0.4943,0.4919,0.4896,0.4872,0.4849,0.4826,0.4803,0.4780,0.4757,0.4735,0.4712,0.4690,0.4668,0.4646,0.4624,0.4602,0.4581,0.4559,0.4538,0.4517,0.4496,0.4475,0.4454,0.4434,0.4413,0.4393,0.4372,0.4352,0.4332,0.4312,0.4293,0.4273,0.4254,0.4234,0.4215,0.4196,0.4177,0.4158,0.4139,0.4120,0.4101,0.4083,0.4065,0.4046,0.4028,0.4010,0.3992,0.3974,0.3956,0.3939,0.3921,0.3904,0.3886,0.3869,0.3852,0.3835,0.3818,0.3801,0.3784,0.3768,0.3751,0.3735,0.3718,0.3702,0.3686,0.3669,0.3653,0.3637,0.3622,0.3606,0.3590,0.3574,0.3559,0.3543,0.3528,0.3513,0.3498,0.3482,0.3467,0.3452,0.3437,0.3423,0.3408,0.3393,0.3379,0.3364,0.3350,0.3335,0.3321,0.3307,0.3293,0.3279,0.3265,0.3251,0.3237,0.3223,0.3209,0.3196,0.3182,0.3169,0.3155,0.3142,0.3129,0.3115,0.3102,0.3089,0.3076,0.3063,0.3050,0.3037,0.3024,0.3012,0.2999,0.2986,0.2974,0.2961,0.2949,0.2937,0.2924,0.2912,0.2900,0.2888,0.2876,0.2864,0.2852,0.2840,0.2828,0.2816,0.2804,0.2793,0.2781,0.2770,0.2758,0.2747,0.2735,0.2724,0.2712,0.2701,0.2690,0.2679,0.2668,0.2657,0.2646,0.2635,0.2624,0.2613,0.2602,0.2591,0.2581,0.2570,0.2559,0.2549,0.2538,0.2528,0.2517,0.2507,0.2497,0.2486,0.2476,0.2466,0.2456,0.2445,0.2435,0.2425,0.2415,0.2405,0.2396,0.2386,0.2376,0.2366,0.2356,0.2347,0.2337,0.2327,0.2318,0.2308,0.2299,0.2289,0.2280,0.2270,0.2261,0.2252,0.2243,0.2233,0.2224,0.2215,0.2206,0.2197,0.2188,0.2179,0.2170,0.2161,0.2152,0.2143,0.2134,0.2126,0.2117,0.2108,0.2099,0.2091,0.2082,0.2074,0.2065,0.2056,0.2048,0.2040,0.2031,0.2023,0.2014,0.2006,0.1998,0.1990,0.1981,0.1973,0.1965,0.1957,0.1949,0.1941,0.1933,0.1925,0.1917,0.1909,0.1901,0.1893,0.1885,0.1877,0.1870,0.1862,0.1854,0.1846,0.1839,0.1831,0.1824,0.1816,0.1808,0.1801,0.1793,0.1786,0.1778,0.1771,0.1764,0.1756,0.1749,0.1742,0.1734,0.1727,0.1720,0.1713,0.1706,0.1698,0.1691,0.1684,0.1677,0.1670,0.1663,0.1656,0.1649,0.1642,0.1635,0.1628,0.1621,0.1615,0.1608,0.1601,0.1594,0.1587,0.1581,0.1574,0.1567,0.1561,0.1554,0.1547,0.1541,0.1534,0.1528,0.1521,0.1515,0.1508,0.1502,0.1495,0.1489,0.1483,0.1476,0.1470,0.1464,0.1457,0.1451,0.1445,0.1438,0.1432,0.1426,0.1420,0.1414,0.1408,0.1401,0.1395,0.1389,0.1383,0.1377,0.1371,0.1365,0.1359,0.1353,0.1347,0.1341,0.1336,0.1330,0.1324,0.1318,0.1312,0.1306,0.1301,0.1295,0.1289,0.1283,0.1278,0.1272,0.1266,0.1261,0.1255,0.1249,0.1244,0.1238,0.1233,0.1227,0.1222,0.1216,0.1211,0.1205,0.1200,0.1194,0.1189,0.1183,0.1178,0.1173,0.1167,0.1162,0.1157,0.1151,0.1146,0.1141,0.1136,0.1130,0.1125,0.1120,0.1115,0.1110,0.1104,0.1099,0.1094,0.1089,0.1084,0.1079,0.1074,0.1069,0.1064,0.1059,0.1054,0.1049,0.1044,0.1039,0.1034,0.1029,0.1024,0.1019,0.1014,0.1009,0.1004,0.1000,0.0995,0.0990,0.0985,0.0980,0.0976,0.0971,0.0966,0.0961,0.0957,0.0952,0.0947,0.0943,0.0938,0.0933,0.0929,0.0924,0.0919,0.0915,0.0910,0.0906,0.0901,0.0897,0.0892,0.0888,0.0883,0.0879,0.0874,0.0870,0.0865,0.0861,0.0856,0.0852,0.0848,0.0843,0.0839,0.0834,0.0830,0.0826,0.0821,0.0817,0.0813,0.0809,0.0804,0.0800,0.0796,0.0792,0.0787,0.0783,0.0779,0.0775,0.0770,0.0766,0.0762,0.0758,0.0754,0.0750,0.0746,0.0742,0.0737,0.0733,0.0729,0.0725,0.0721,0.0717,0.0713,0.0709,0.0705,0.0701,0.0697,0.0693,0.0689,0.0685,0.0681,0.0677,0.0673,0.0670,0.0666,0.0662,0.0658,0.0654,0.0650,0.0646,0.0643,0.0639,0.0635,0.0631,0.0627,0.0623,0.0620,0.0616,0.0612,0.0608,0.0605,0.0601,0.0597,0.0594,0.0590,0.0586,0.0583,0.0579,0.0575,0.0572,0.0568,0.0564,0.0561,0.0557,0.0553,0.0550,0.0546,0.0543,0.0539,0.0536,0.0532,0.0528,0.0525,0.0521,0.0518,0.0514,0.0511,0.0507,0.0504,0.0500,0.0497,0.0494,0.0490,0.0487,0.0483,0.0480,0.0476,0.0473,0.0470,0.0466,0.0463,0.0460,0.0456,0.0453,0.0449,0.0446,0.0443,0.0439,0.0436,0.0433,0.0430,0.0426,0.0423,0.0420,0.0417,0.0413,0.0410,0.0407,0.0404,0.0400,0.0397,0.0394,0.0391,0.0388,0.0384,0.0381,0.0378,0.0375,0.0372,0.0369,0.0365,0.0362,0.0359,0.0356,0.0353,0.0350,0.0347,0.0344,0.0341,0.0338,0.0334,0.0331,0.0328,0.0325,0.0322,0.0319,0.0316,0.0313,0.0310,0.0307,0.0304,0.0301,0.0298,0.0295,0.0292,0.0289,0.0286,0.0283,0.0281,0.0278,0.0275,0.0272,0.0269,0.0266,0.0263,0.0260,0.0257,0.0254,0.0252,0.0249,0.0246,0.0243,0.0240,0.0237,0.0234,0.0232,0.0229,0.0226,0.0223,0.0220,0.0218,0.0215,0.0212,0.0209,0.0206,0.0204,0.0201,0.0198,0.0195,0.0193,0.0190,0.0187,0.0185,0.0182,0.0179,0.0176,0.0174,0.0171,0.0168,0.0166,0.0163,0.0160,0.0158,0.0155,0.0152,0.0150,0.0147,0.0144,0.0142,0.0139,0.0137,0.0134,0.0131,0.0129,0.0126,0.0124,0.0121,0.0119,0.0116,0.0113,0.0111,0.0108,0.0106,0.0103,0.0101,0.0098,0.0096,0.0093,0.0091,0.0088,0.0086,0.0083,0.0081,0.0078,0.0076,0.0073,0.0071,0.0068,0.0066,0.0063,0.0061,0.0058,0.0056,0.0053,0.0051,0.0049,0.0046,0.0044,0.0041,0.0039,0.0037,0.0034,0.0032,0.0029,0.0027,0.0025,0.0022,0.0020,0.0018,0.0015,0.0013,0.0011,0.0008,0.0006,0.0004,0.0001,-6.209,-0.000,-0.000,-0.000,-0.000,-0.001,-0.001,-0.001,-0.001,-0.002,-0.002,-0.002,-0.002,-0.003,-0.003,-0.003,-0.003,-0.003,-0.004,-0.004,-0.004,-0.004,-0.005,-0.005,-0.005,-0.005,-0.005,-0.006,-0.006,-0.006,-0.006,-0.007,-0.007,-0.007,-0.007,-0.007,-0.008,-0.008,-0.008,-0.008,-0.008,-0.009,-0.009,-0.009,-0.009,-0.010,-0.010,-0.010,-0.010,-0.010,-0.011,-0.011,-0.011,-0.011,-0.011,-0.012,-0.012,-0.012,-0.012,-0.012,-0.013,-0.013,-0.013,-0.013,-0.013,-0.014,-0.014,-0.014,-0.014,-0.015,-0.015,-0.015,-0.015,-0.015,-0.016,-0.016,-0.016,-0.016,-0.016,-0.017,-0.017,-0.017];


var myheight = 750;

//var pixels_per_M = 30;
var BH_screen_dist = 150;
var myfrac = .15; //what fraction of the total minimum axis (height or width) you want the BH radius to be
function handleImage(e){
    var reader = new FileReader();
    reader.onload = function(event){
        var img = new Image();
        img.onload = function(){
            canvas.width = img.width; 
            canvas.height = img.height;
            var renorm = canvas.height / myheight;
            canvas.height = canvas.height/renorm;
            canvas.width = canvas.width/renorm;

            ctx.drawImage(img,0,0,canvas.width,canvas.height);
        }
        img.src = event.target.result;
    }
    reader.readAsDataURL(e.target.files[0]);     
}


function renderFunc(){
    var imgData = ctx.getImageData(0,0,canvas.width, canvas.height);
	        var newimgData = ctx.createImageData(imgData);                
            //var newimgData = ctx.createImageData(ImgData);
            //canvas2.width = canvas.width;
            //canvas2.height = canvas.height;

            var radius=3.3;
            var xhlf = canvas.width/2;
            var yhlf = canvas.height/2;
            var mymin = Math.min(canvas.width,canvas.height);
            var pixelfrac = myfrac*mymin;
            var pixels_per_M = pixelfrac / radius;

            //let's make the black hole a fixed fraction of the minimum axis
            var i;
            for (i=0;i<newimgData.data.length;i+=4){
                var truei = Math.floor(i/4);
                var tmpy = Math.floor(truei / canvas.width);
                var tmpx = truei % canvas.width;
                var deltax = tmpx-xhlf;
                var deltay = tmpy-yhlf;
                var myr2 = deltax*deltax + deltay*deltay;
                var myr = Math.sqrt(myr2)/pixels_per_M;
                var myrpixels = myr*pixels_per_M;
                
                //need to find element in a list that is closest to myr (keep track of units, multiply alist by 2)

                if (myr > radius){
                    //find impact value closest to ours
                    var j;
                    var mindex;
                    var mymin=100;
                    var mydef;
                    for (j=0;j<impactlist.length;j+=1){
                        if (Math.abs(2*impactlist[j]-myr)<mymin)
                            {
                                mymin = Math.abs(2*impactlist[j]-myr);
                                mindex = j;
                            }
                    }
                mydef = deflist[mindex];
                var mytan = Math.tan(mydef);
                var offset = BH_screen_dist*mytan;
                var sinphi = deltay/myrpixels;
                var cosphi = deltax/myrpixels;
                var ychange = offset*sinphi;
                var xchange = offset*cosphi;
                //console.log(xchange);
                //console.log(ychange);
                var newy = Math.round(tmpy - ychange);
                var newx = Math.round(tmpx - xchange);

                if (newy >= canvas.height)
                {newy=canvas.height-1;
                }
                if (newy < 0)
                {newy=0;
                }
                if (newx >= canvas.width)
                {newx=canvas.width-1;
                }
                if (newx < 0)
                {newx=0;
                }
                //now need to convert x-y values into flattened array index
                var newi = 4*(newy*canvas.width + newx);
                
                //defining our new pixel vals
                newimgData.data[i]=imgData.data[newi];
                newimgData.data[i+1]=imgData.data[newi+1];  
                newimgData.data[i+2]=imgData.data[newi+2];
                newimgData.data[i+3]=imgData.data[newi+3];
                }
                else{
                newimgData.data[i] =0;
                newimgData.data[i+1]=0;
                newimgData.data[i+2]=0;  
                newimgData.data[i+3]=255; 

}
            }
            ctx.putImageData(newimgData,0,0);
}
</script>



</html>
